VERSION 5.00
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0"; "comdlg32.ocx"
Begin VB.Form frm_Main 
   Caption         =   "Create Wappo Level :)"
   ClientHeight    =   8115
   ClientLeft      =   3825
   ClientTop       =   1560
   ClientWidth     =   9525
   Icon            =   "Form1.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   8115
   ScaleWidth      =   9525
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   35
      Left            =   2880
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   56
      Top             =   2760
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   34
      Left            =   2400
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   55
      Top             =   2760
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   33
      Left            =   1920
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   54
      Top             =   2760
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   32
      Left            =   1440
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   53
      Top             =   2760
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   31
      Left            =   960
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   52
      Top             =   2760
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   30
      Left            =   480
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   51
      Top             =   2760
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   29
      Left            =   2880
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   50
      Top             =   2280
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   28
      Left            =   2400
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   49
      Top             =   2280
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   27
      Left            =   1920
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   48
      Top             =   2280
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   26
      Left            =   1440
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   47
      Top             =   2280
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   25
      Left            =   960
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   46
      Top             =   2280
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   24
      Left            =   480
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   45
      Top             =   2280
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   23
      Left            =   2880
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   44
      Top             =   1800
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   22
      Left            =   2400
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   43
      Top             =   1800
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   21
      Left            =   1920
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   42
      Top             =   1800
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   20
      Left            =   1440
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   41
      Top             =   1800
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   19
      Left            =   960
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   40
      Top             =   1800
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   18
      Left            =   480
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   39
      Top             =   1800
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   17
      Left            =   2880
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   38
      Top             =   1320
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   16
      Left            =   2400
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   37
      Top             =   1320
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   15
      Left            =   1920
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   36
      Top             =   1320
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   14
      Left            =   1440
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   35
      Top             =   1320
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   13
      Left            =   960
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   34
      Top             =   1320
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   12
      Left            =   480
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   33
      Top             =   1320
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   11
      Left            =   2880
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   32
      Top             =   840
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   10
      Left            =   2400
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   31
      Top             =   840
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   9
      Left            =   1920
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   30
      Top             =   840
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   8
      Left            =   1440
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   29
      Top             =   840
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   7
      Left            =   960
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   28
      Top             =   840
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   6
      Left            =   480
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   27
      Top             =   840
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   5
      Left            =   2880
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   26
      Top             =   360
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   4
      Left            =   2400
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   25
      Top             =   360
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   3
      Left            =   1920
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   24
      Top             =   360
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   2
      Left            =   1440
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   23
      Top             =   360
      Width           =   495
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   1
      Left            =   960
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   22
      Top             =   360
      Width           =   495
   End
   Begin VB.CommandButton btn_Add 
      Caption         =   "Wall"
      Height          =   375
      Index           =   4
      Left            =   7320
      TabIndex        =   21
      Top             =   3240
      Width           =   1095
   End
   Begin VB.CommandButton btn_Add 
      Caption         =   "Hole"
      Height          =   375
      Index           =   3
      Left            =   7320
      TabIndex        =   20
      Top             =   2760
      Width           =   1095
   End
   Begin VB.CommandButton btn_Add 
      Caption         =   "YumChack"
      Height          =   375
      Index           =   2
      Left            =   7320
      TabIndex        =   19
      Top             =   2280
      Width           =   1095
   End
   Begin VB.CommandButton btn_Add 
      Caption         =   "Door"
      Height          =   375
      Index           =   1
      Left            =   7320
      TabIndex        =   18
      Top             =   1800
      Width           =   1095
   End
   Begin VB.CommandButton btn_Add 
      Caption         =   "Player"
      Height          =   375
      Index           =   0
      Left            =   7320
      TabIndex        =   17
      Top             =   1320
      Width           =   1095
   End
   Begin VB.Frame frame_Walls 
      Caption         =   "Walls"
      Height          =   2535
      Left            =   360
      TabIndex        =   14
      Top             =   4320
      Width           =   2895
      Begin VB.ListBox list_Walls 
         Height          =   2010
         Left            =   120
         TabIndex        =   16
         Top             =   360
         Width           =   1575
      End
      Begin VB.CommandButton btn_wClear 
         Caption         =   "Clear"
         Height          =   375
         Left            =   1800
         TabIndex        =   15
         Top             =   360
         Width           =   975
      End
   End
   Begin VB.PictureBox Board 
      BackColor       =   &H80000000&
      BorderStyle     =   0  'None
      Height          =   495
      Index           =   0
      Left            =   480
      ScaleHeight     =   495
      ScaleWidth      =   495
      TabIndex        =   13
      Top             =   360
      Width           =   495
   End
   Begin MSComDlg.CommonDialog FileDialog 
      Left            =   9960
      Top             =   3600
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   393216
      Filter          =   "Wappo Level(*.wlv)|*.wlv|All Files(*.*)|*.*"
   End
   Begin VB.CommandButton btn_loadLevel 
      Caption         =   "Load"
      Height          =   375
      Left            =   4320
      TabIndex        =   6
      Top             =   1080
      Width           =   975
   End
   Begin VB.TextBox tBox_Level 
      Height          =   285
      Left            =   4320
      TabIndex        =   5
      Top             =   720
      Width           =   1215
   End
   Begin VB.Frame frame_Killers 
      Caption         =   "YumChacks"
      Height          =   2535
      Left            =   4200
      TabIndex        =   2
      Top             =   1920
      Width           =   2895
      Begin VB.CommandButton btn_kClear 
         Caption         =   "Clear"
         Height          =   375
         Left            =   1800
         TabIndex        =   11
         Top             =   360
         Width           =   975
      End
      Begin VB.ListBox list_Killers 
         Height          =   2010
         Left            =   120
         TabIndex        =   3
         Top             =   360
         Width           =   1575
      End
   End
   Begin VB.Frame frame_Holes 
      Caption         =   "Holes"
      Height          =   2535
      Left            =   4200
      TabIndex        =   0
      Top             =   4680
      Width           =   2895
      Begin VB.CommandButton btn_hClear 
         Caption         =   "Clear"
         Height          =   375
         Left            =   1800
         TabIndex        =   12
         Top             =   360
         Width           =   975
      End
      Begin VB.ListBox list_Holes 
         Height          =   2010
         Left            =   120
         TabIndex        =   1
         Top             =   360
         Width           =   1575
      End
   End
   Begin VB.Shape Shape1 
      Height          =   3135
      Left            =   360
      Top             =   240
      Width           =   3135
   End
   Begin VB.Label label_curLevel 
      Height          =   255
      Left            =   6960
      TabIndex        =   10
      Top             =   720
      Width           =   255
   End
   Begin VB.Label Label2 
      Caption         =   "Current level :"
      Height          =   255
      Left            =   5880
      TabIndex        =   9
      Top             =   720
      Width           =   975
   End
   Begin VB.Label label_nLevels 
      Height          =   255
      Left            =   6960
      TabIndex        =   8
      Top             =   480
      Width           =   255
   End
   Begin VB.Label Label1 
      Caption         =   "All levels :"
      Height          =   255
      Left            =   5880
      TabIndex        =   7
      Top             =   480
      Width           =   975
   End
   Begin VB.Label lbl_Level 
      Caption         =   "Load level"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   4320
      TabIndex        =   4
      Top             =   480
      Width           =   1095
   End
   Begin VB.Menu MFile 
      Caption         =   "File"
      Begin VB.Menu MFileNew 
         Caption         =   "New file"
      End
      Begin VB.Menu MFileLoad 
         Caption         =   "Load file"
      End
      Begin VB.Menu MFileSave 
         Caption         =   "Save file"
      End
   End
   Begin VB.Menu MLevel 
      Caption         =   "Level"
      Begin VB.Menu MLevelNew 
         Caption         =   "New level"
      End
      Begin VB.Menu MLevelSave 
         Caption         =   "Save level"
      End
   End
End
Attribute VB_Name = "frm_Main"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Dim myLevels As WAPPOSERVERLib.WLevels
Dim curButton As Integer
Dim fL As Integer
Dim fC As Integer

Private Sub Board_Click(Index As Integer)
Dim i As Integer
Dim j As Integer
Dim szBuf As String
    
    i = Index \ 6 + 1
    j = Index Mod 6 + 1
        

    If curButton = 0 Then
        myLevels.put_Player i, j
        
    Else
    If curButton = 1 Then
        myLevels.put_Door i, j
    Else
    If curButton = 2 Then
        If myLevels.put_Killer(i, j) = 1 Then
            szBuf = "(" & i & " , " & j & ")"
            list_Killers.AddItem szBuf
        End If
    Else
    If curButton = 3 Then
        If myLevels.put_Hole(i, j) = 1 Then
            szBuf = "(" & i & " , " & j & ")"
            list_Holes.AddItem szBuf
        End If
    Else
    If curButton = 4 Then
        If fL >= 0 Then
            If myLevels.put_Wall(fL, fC, i, j) = 1 Then
                szBuf = "(" & fL & " , " & fC & ") - ( " & i & " , " & j & ")"
                list_Walls.AddItem szBuf
            End If
            fL = -1
            fC = -1
        Else
            fL = i
            fC = j
        End If
    End If
    End If
    End If
    End If
    End If
    
    Print_Board
End Sub

Private Sub btn_Add_Click(Index As Integer)
' 0 - Player
' 1 - Door
' 2 - Killer
' 3 - Hole
' 4 - Wall

    curButton = Index
    
End Sub

Private Sub btn_hClear_Click()
    list_Holes.Clear
    myLevels.clear_Holes
    Print_Board
End Sub

Private Sub btn_kClear_Click()
    list_Killers.Clear
    myLevels.clear_Killers
    Print_Board
End Sub

Private Sub btn_loadLevel_Click()
Dim nLevels
    nLevels = myLevels.nLevels
    
    If nLevels >= tBox_Level.Text Then
        myLevels.loadLevel tBox_Level.Text
        label_curLevel = tBox_Level.Text
        tBox_Level.Text = ""
        Print_Board
        Print_List
    End If
End Sub

Private Sub btn_wClear_Click()
    list_Walls.Clear
    myLevels.clear_Walls
    Print_Board
End Sub

Private Sub Form_Load()
    Set myLevels = New WLevels
    MLevelNew.Enabled = False
    MLevelSave.Enabled = False
    MFileSave.Enabled = False
            
    fL = -1
    fC = -1
End Sub

Private Sub Form_Unload(Cancel As Integer)
Dim frmInstance As Form

    For Each frmInstance In Forms
        Unload frmInstance
    Next

    Set myLevels = Nothing
    Set frmInstance = Nothing
End Sub


Private Sub Print_Board()
Dim i As Integer
Dim j As Integer
Dim Temp As Long

For i = 0 To 5
   For j = 0 To 5
       Temp = myLevels.Board(i, j)
       
       If Temp = 3 Then ' Door
            If i = 0 Then
                With Board(i * 6 + j)
                    .Cls
                    .Picture = Library.Board_l(7)
                    .Refresh
                End With
            Else
            If i = 5 Then
                With Board(i * 6 + j)
                    .Cls
                    .Picture = Library.Board_l(5)
                    .Refresh
                End With
            Else
            If j = 0 Then
                With Board(i * 6 + j)
                    .Cls
                    .Picture = Library.Board_l(8)
                    .Refresh
                End With
            Else
            If j = 5 Then
                With Board(i * 6 + j)
                    .Cls
                    .Picture = Library.Board_l(6)
                    .Refresh
                End With
            End If
            End If
            End If
            End If
        Else
        If Temp = 4 Then ' Hole
           With Board(i * 6 + j)
             .Cls
             .Picture = Library.Board_l(3)
             .Refresh
           End With
        Else
        If Temp = 5 Then ' Big Killer
           With Board(i * 6 + j)
             .Cls
             .Picture = Library.Board_l(4)
             .Refresh
           End With
        Else
           With Board(i * 6 + j)
             .Picture = Library.Board_l(Temp)
           End With
        End If
        End If
        End If
   Next j
Next i
DrawWalls
End Sub

Private Sub Print_List()
Dim i As Integer
Dim j As Integer
Dim szBuf As String

Dim nWalls As Integer
Dim nKillers As Integer
Dim nHoles As Integer

Dim fL As Long
Dim sL As Long
Dim fC As Long
Dim sC As Long

list_Killers.Clear
list_Holes.Clear
list_Walls.Clear

nWalls = myLevels.nWalls
nKillers = myLevels.nKillers
nHoles = myLevels.nHoles

For i = 0 To nWalls - 1
    myLevels.get_Wall i, fL, fC, sL, sC
    szBuf = "(" & fL + 1 & " , " & fC + 1 & ") - (" & sL + 1 & " , " & sC + 1 & ")"
    list_Walls.AddItem szBuf
Next i

For i = 0 To nKillers - 1
    myLevels.get_Killer i, fL, fC
    szBuf = "(" & fL + 1 & " , " & fC + 1 & ")"
    list_Killers.AddItem szBuf
Next i

For i = 0 To nHoles - 1
    myLevels.get_Hole i, fL, fC
    szBuf = "(" & fL + 1 & " , " & fC + 1 & ")"
    list_Holes.AddItem szBuf
Next i
End Sub

Private Sub DrawWall(Direction As Integer, nIndex As Integer)
' 1 - Left
' 2 - Right
' 3 - Up
' 4 - Down

Dim FirstX As Integer
Dim FirstY As Integer
Dim SecondX As Integer
Dim SecondY As Integer

With Board(nIndex)
   ScaleMode = vbPixels 'set form scalemode to pixels
   .ScaleMode = vbPixels 'picture as well
   .BorderStyle = 0 'no border so width = scalewidth height = scaleheight
   .Width = 32  'size the box to 32 x 32
   .Height = 32
   .DrawWidth = 3 '3 pixels wide, centered on the middle pixel
  'Draw Outline box, since we draw around the edge, 2 pixels are "in" the
  'box, 1 pixel is "outside" the box, so not seen.

If Direction = 1 Then
   FirstX = 0
   FirstY = 0
   SecondX = 0
   SecondY = Board(nIndex).ScaleHeight
Else
'If Direction = 2 Then
'    FirstX = Board(nIndex).ScaleWidth - 1
'    FirstY = 0
'    SecondX = Board(nIndex).ScaleWidth - 1
'    SecondY = Board(nIndex).ScaleHeight - 1
'Else
If Direction = 3 Then
   FirstX = 0
   FirstY = 0
   SecondX = Board(nIndex).ScaleWidth
   SecondY = 0
'Else
'If Direction = 4 Then
'    FirstX = 0
'    FirstY = Board(nIndex).ScaleHeight - 1
'    SecondX = 32
'    SecondY = Board(nIndex).ScaleHeight - 1
'End If
'End If
End If
End If
   Board(nIndex).Line (FirstX, FirstY)-(SecondX, SecondY), vbBlack, B
End With
End Sub


Private Sub DrawWalls()
   Dim nWalls As Integer
   Dim i As Integer
   Dim fL As Long
   Dim fC As Long
   Dim sL As Long
   Dim sC As Long

   nWalls = myLevels.nWalls
   For i = 0 To nWalls - 1
       myLevels.get_Wall i, fL, fC, sL, sC

       If fL = sL Then
           If fC < sC Then
               'DrawWall 2, fL * 6 + fC
               DrawWall 1, sL * 6 + sC
           Else
               'DrawWall 2, sL * 6 + sC
               DrawWall 1, fL * 6 + fC
           End If
       Else
       If fC = sC Then
           If fL < sL Then
               'DrawWall 4, fL * 6 + fC
               DrawWall 3, sL * 6 + sC
           Else
               'DrawWall 4, sL * 6 + sC
               DrawWall 3, fL * 6 + fC
           End If
       End If
       End If
   Next i
End Sub

Private Sub MFileLoad_Click()
    FileDialog.FileName = ""
    FileDialog.DialogTitle = "Select input file"
    FileDialog.ShowOpen
    
    If Not FileDialog.FileName = "" Then
        myLevels.Open FileDialog.FileName
        
        label_nLevels.Caption = myLevels.nLevels
        label_curLevel.Caption = 1
        
        MLevelNew.Enabled = True
        MLevelSave.Enabled = True
        MFileSave.Enabled = True
        
        Print_Board
        Print_List
    End If
End Sub

Private Sub MFileNew_Click()
    myLevels.New
    
    label_nLevels.Caption = myLevels.nLevels
    label_curLevel.Caption = 1
    
    MLevelNew.Enabled = True
    MLevelSave.Enabled = True
    MFileSave.Enabled = True
    
    Print_Board
End Sub

Private Sub MFileSave_Click()
    FileDialog.FileName = ""
    FileDialog.DialogTitle = "Select input file"
    FileDialog.ShowSave
    
    If Not FileDialog.FileName = "" Then
        myLevels.Save FileDialog.FileName
    End If
End Sub

Private Sub MLevelNew_Click()
    myLevels.newLevel
    label_curLevel = myLevels.nLevels + 1
    
    list_Holes.Clear
    list_Killers.Clear
    list_Walls.Clear
    
    Print_Board
End Sub

Private Sub MLevelSave_Click()
    myLevels.saveLevel
    label_nLevels.Caption = myLevels.nLevels
End Sub
